all:
  vars:
    ### ansible-pacemaker
    HACLUSTER_PASSWORD: pacemaker
    CLUSTER_NAME: cluster_name
    FENCE_AGENTS: [fence_ipmilan]
    #FENCE_AGENTS: [fence_sbd]
    pm_extra_tools: 1.6-1.el9

    ### ansible-postgresql-shared
    pg_rev: '16.2-1PGDG.rhel9'

    ### ansible-virtualbmc
    VBMC_HYPERVISOR: vbox
    VBMC_VERSION: devel-vbox-2.0		# for VirtualBox
    VBMC_VENV_DIR: ./venv-vbmc
    VBMC_IPMI_IF: eth0
    VBMC_WSL2_SUBNET_IP: 192.168.99.1


hacluster:
  hosts:
    node1:
      manage_addr: 192.168.56.11
      link0_addr:  192.168.57.11
      link1_addr:  192.168.58.11
    node2:
      manage_addr: 192.168.56.12
      link0_addr:  192.168.57.12
      link1_addr:  192.168.58.12

### ansible-pacemaker examples
hacluster_resources:
  children:
    hacluster:
  vars:
    # pcsgen_cvs - relative path from ansible-pacemaker for running from import_playbook
    pcsgen_csv: "{{ playbook_dir }}/../pm_pcsgen-config/pm_pcsgen_osc2022fall.csv"
    ipaddr: { ip: 192.168.59.101, nic: eth4, cidr_netmask: 24 }
    ping:   { host_list: 192.168.59.1 }
    pgsql:
      pgctl: /usr/pgsql-16/bin/pg_ctl
      psql:  /usr/pgsql-16/bin/psql
      pgdata: "{{ PGDATA }}"
      pgport: "{{ PGPORT }}"

### ansible-postgresql-shared
# for iSCSI shared storage configuration
iscsi_target:
  hosts:
    storage:

iscsi_initiator:
  children:
    hacluster:

iscsi:
  children:
    iscsi_target:
    iscsi_initiator:
  vars:
    TARGET_PORTS: # multipath
      - 192.168.56.19:3260
      - 192.168.57.19:3260
    TARGET_IQN: iqn.2022-09.local.storage:storage1
    TARGET_LUNS:
      - { name: lun0, size: 4M }
      - { name: lun1, size: 1G }
      - { name: lun2, size: 1G }
      - { name: lun3, size: 1G }

# PostgreSQL shared storage configuration variables
hacluster_shared:
  children:
    hacluster:
  vars:
    SHAREDDISK_PARTITIONS:
      /dev/mapper/mpatha:
        - { number: 1, part_start:     0%, part_end:   100%, fstype: }
      /dev/mapper/mpathb:
        - { number: 1, part_start:     0%, part_end:   100%, fstype: xfs }
      /dev/mapper/mpathc:
        - { number: 1, part_start:     0%, part_end:   100%, fstype: xfs }
      /dev/mapper/mpathd:
        - { number: 1, part_start:     0%, part_end:   100%, fstype: xfs }

    SBD_DEVICE: /dev/mapper/mpatha1
    PG_FILESYSTEMS:
      - { resourceid: filesystem1, mountpoint: /shared/pgdata, device: /dev/mapper/mpathb1 }
      - { resourceid: filesystem2, mountpoint: /shared/pgwal,  device: /dev/mapper/mpathc1 }
      - { resourceid: filesystem3, mountpoint: /shared/pgarch, device: /dev/mapper/mpathd1 }
    # (Optional) subdirectories to be created under the mountpoints if necessary
    PG_SUBDIRECTORIES:
      - /shared/pgdata/data

    PGDATA: /shared/pgdata/data
    PGPORT: 5432
    PG_INITDB_OPTS: --encoding=UTF-8 --no-locale
    # (Optional) create customized files and define these variables if necessary
    #PG_HBA_CONF_FILE: {{ role_path }}/files/pg_hba.conf
    #POSTGRESQL_CONF_FILE: {{ role_path }}/files/postgresql.conf


### ansible-virtualbmc
hacluster_vbmc:
  hosts:
    node1:
      IPMI_IP:   192.168.99.91
      IPMI_USER: pacemaker
      IPMI_PASS: pacemakerpass1
    node2:
      IPMI_IP:   192.168.99.92
      IPMI_USER: pacemaker
      IPMI_PASS: pacemakerpass1

### vagrant
hostvars_vagrant:
  hosts:
    node1:
      ansible_host: 192.168.56.11
      ansible_user: vagrant
      ansible_ssh_private_key_file: ./vagrant/.vagrant/machines/node1/virtualbox/private_key
    node2:
      ansible_host: 192.168.56.12
      ansible_user: vagrant
      ansible_ssh_private_key_file: ./vagrant/.vagrant/machines/node2/virtualbox/private_key
    storage:
      ansible_host: 192.168.56.19
      ansible_user: vagrant
      ansible_ssh_private_key_file: ./vagrant/.vagrant/machines/storage/virtualbox/private_key

